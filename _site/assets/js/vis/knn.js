function TopK(){return obj={},obj.items=[],obj.dist=function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))},obj.enqueue=function(t,e,n){added=!1,d=obj.dist(e,[t[0],t[1]]);for(var i=0;i<obj.items.length;i++)if(obj.items[i][1]>d){obj.items.splice(i,0,[t,d]),added=!0;break}obj.items.length>n&&obj.items.pop(),!added&&obj.items.length<n&&obj.items.push([t,d])},obj.find=function(t,e,n){return t.forEach(function(t){obj.enqueue(t,e,n)}),result=[],obj.items.forEach(function(t){result.push(t[0])}),result},obj}function format(t){extentX=d3.extent(t,function(t){return t.x}),extentY=d3.extent(t,function(t){return t.y}),data=t.map(function(t){return[(t.x-extentX[0])/extentX[1],(t.y-extentY[0])/extentY[1]]}),vis=genVis(data)}function genVis(t){var e=this;return e.k=document.getElementById("knn-slider").value,e.margin={top:20,right:20,bottom:30,left:40},e.width=$(".blog-container").width()/2-margin.left-margin.right,e.height=$(".blog-container").width()/2.5-margin.top-margin.bottom,t=t.map(function(t){return[t[0]*e.width,t[1]*e.height]}),e.svg=d3.select("#knn").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),e.points=svg.append("g").attr("class","points").selectAll("circle").data(t).enter().append("circle").attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]}).attr("r",2).style("opacity",.5),e.hull=e.svg.append("path").attr("class","hull").style("opacity",.5).style("fill","red"),e.svg.mousemove=function(t){q=TopK();var n=d3.mouse(this.node()),i=q.find(t,n,e.k);e.hull.datum(d3.polygonHull(i)).attr("d",function(t){return"M"+t.join("L")+"Z"}),points.style("fill",function(t){return-1!==i.indexOf(t)?"red":null})},e.svg.append("rect").attr("width",width).attr("height",height).style("fill-opacity",0).on("mousemove",function(){e.svg.mousemove(t)}),e.svg.append("text").attr("x",e.width/2).attr("y",e.height).text("GPA"),e.svg.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-e.height/2).attr("y",0).text("STEM classes"),e}d3.csv("/assets/data/sin-data.csv",function(t,e){format(e)}),document.getElementById("knn-slider").oninput=function(){vis.k=this.value,document.getElementById("knn-slider-label").innerHTML=this.value};