// Copyright (c) 2013 Justin Palmer
d3.tip=function(){function t(t){g=d(t),w=g.createSVGPoint(),document.body.appendChild(v)}function e(){return"n"}function n(){return[0,0]}function r(){return" "}function o(){var t=y();return{top:t.n.y-v.offsetHeight,left:t.n.x-v.offsetWidth/2}}function l(){var t=y();return{top:t.s.y,left:t.s.x-v.offsetWidth/2}}function f(){var t=y();return{top:t.e.y-v.offsetHeight/2,left:t.e.x}}function i(){var t=y();return{top:t.w.y-v.offsetHeight/2,left:t.w.x-v.offsetWidth}}function s(){var t=y();return{top:t.nw.y-v.offsetHeight,left:t.nw.x-v.offsetWidth}}function u(){var t=y();return{top:t.ne.y-v.offsetHeight,left:t.ne.x}}function a(){var t=y();return{top:t.sw.y,left:t.sw.x-v.offsetWidth}}function c(){var t=y();return{top:t.se.y,left:t.e.x}}function p(){var t=d3.select(document.createElement("div"));return t.style({position:"absolute",opacity:0,pointerEvents:"none",boxSizing:"border-box"}),t.node()}function d(t){return t=t.node(),"svg"==t.tagName.toLowerCase()?t:t.ownerSVGElement}function y(){var t=T||d3.event.target,e={},n=t.getScreenCTM(),r=t.getBBox(),o=r.width,l=r.height,f=r.x,i=r.y,s=document.documentElement.scrollTop||document.body.scrollTop,u=document.documentElement.scrollLeft||document.body.scrollLeft;return w.x=f+u,w.y=i+s,e.nw=w.matrixTransform(n),w.x+=o,e.ne=w.matrixTransform(n),w.y+=l,e.se=w.matrixTransform(n),w.x-=o,e.sw=w.matrixTransform(n),w.y-=l/2,e.w=w.matrixTransform(n),w.x+=o,e.e=w.matrixTransform(n),w.x-=o/2,w.y-=l/2,e.n=w.matrixTransform(n),w.y+=l,e.s=w.matrixTransform(n),e}var m=e,h=n,x=r,v=p(),g=null,w=null,T=null;t.show=function(){var e=Array.prototype.slice.call(arguments);e[e.length-1]instanceof SVGElement&&(T=e.pop());var n,r=x.apply(this,e),o=h.apply(this,e),l=m.apply(this,e),f=d3.select(v),i=0;for(f.html(r).style({opacity:1,"pointer-events":"all"});i--;)f.classed(E[i],!1);return n=b.get(l).apply(this),f.classed(l,!0).style({top:n.top+o[0]+"px",left:n.left+o[1]+"px"}),t},t.hide=function(){return nodel=d3.select(v),nodel.style({opacity:0,"pointer-events":"none"}),t},t.attr=function(e){if(arguments.length<2&&"string"==typeof e)return d3.select(v).attr(e);var n=Array.prototype.slice.call(arguments);return d3.selection.prototype.attr.apply(d3.select(v),n),t},t.style=function(e){if(arguments.length<2&&"string"==typeof e)return d3.select(v).style(e);var n=Array.prototype.slice.call(arguments);return d3.selection.prototype.style.apply(d3.select(v),n),t},t.direction=function(e){return arguments.length?(m=null==e?e:d3.functor(e),t):m},t.offset=function(e){return arguments.length?(h=null==e?e:d3.functor(e),t):h},t.html=function(e){return arguments.length?(x=null==e?e:d3.functor(e),t):x};var b=d3.map({n:o,s:l,e:f,w:i,nw:s,ne:u,sw:a,se:c}),E=b.keys();return t};