function genVis(t,e,a){t.parentElement=e,t.data=a,t.margin=margin,t.width=$(e).width()-margin.left-margin.right,t.height=$(e).height()-margin.top-margin.bottom,t.svg=d3.select(e).append("svg").attr({width:t.width+margin.left+margin.right,height:t.height+margin.top+margin.bottom,"class":"svg-content"})}function triggerUpdates(t){stackedAreaChart.updateVis(t),treeMap.updateVis(t)}var TOTALWATER="TOWTotl",TOTALSURFACE="TOWSWTo",TOTALGROUND="TOWGWTo",margin={top:20,left:20,right:20,bottom:20},choropleth,treeMap,stackedAreaChart,twitterFeed,regionChanged=!1;queue().defer(d3.json,"data/data.json").defer(d3.json,"data/us-10m.json").await(function(t,e,a){var i=0;e.forEach(function(t){t.states.forEach(function(t){t.id=i++}),i=0}),choropleth=new Choropleth(a),treeMap=new TreeMap(e),stackedAreaChart=new StackedAreaChart,twitterFeed=new TwitterFeed,genVis(choropleth,"#choropleth",e),genVis(stackedAreaChart,"#stacked-area",e),genVis(twitterFeed,"twitter-feed",e),choropleth.initVis(),treeMap.initVis(),stackedAreaChart.initVis(),twitterFeed.initVis()}),$(".year").change(function(){choropleth.updateVis()}),$("#gw").click(function(t){if(!$("#sw").is(":checked")&&!$(this).is(":checked"))return t.preventDefault(),t.stopPropagation(),!1;choropleth.updateVis()}),$("#sw").click(function(t){if(!$("#gw").is(":checked")&&!$(this).is(":checked"))return t.preventDefault(),t.stopPropagation(),!1;choropleth.updateVis()}),$(".region").change(function(){regionChanged=!0,choropleth.updateVis()}),$("#p3").prepend('<h3 name="p3">See the data for yourself</h3>'),$("#to_p2").click(function(t){var e="#"+t.target.getAttribute("name");return $("html, body").animate({scrollTop:$(e).offset().top},500),!1}),$("#to_p3").click(function(t){var e="#"+t.target.getAttribute("name");return $("html, body").animate({scrollTop:$(e).offset().top},500),!1});