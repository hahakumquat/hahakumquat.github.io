function renderLine(){c.setLineDash([2*pW,2*pW]),c.strokeStyle="white",c.lineWidth=20,c.beginPath(),c.moveTo(w/2,0),c.lineTo(w/2,h),c.stroke()}function step(){update(),render(),animate(step)}function render(){c.fillStyle="#000000",c.fillRect(0,0,w,h),p1.render(),p2.render(),ball.render(),renderLine()}function Paddle(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s,this.x_speed=0,this.y_speed=0,this.points=0}function Score(e,t,i){this.text=e,this.x=t,this.y=i}function Player1(){this.paddle=new Paddle(pW,h/2-pH/2,pW,pH),this.score=new Score(this.paddle.points,w/2-190,140)}function Player2(){this.paddle=new Paddle(w-2*pW,h/2-pH/2,pW,pH),this.score=new Score(this.paddle.points,w/2+190,140)}function Ball(e,t){var i=8;this.x=e,this.y=t,this.x_speed=-i,this.y_speed=-i,this.radius=pW/2}var animate=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},w=$(window).width(),h=$(window).height(),canvas=document.createElement("canvas");canvas.width=w,canvas.height=h;var c=canvas.getContext("2d"),pH=.2*h,pW=Math.max(20,.1*pH),p1=new Player1,p2=new Player2,ball=new Ball(w/2,h/2),spd=8,mouse=h/2,new_mouse=h/2;$(function(){$("body").css("overflow","hidden"),document.body.appendChild(canvas),animate(step)});var update=function(){p1.update(),p2.update(),ball.update(p1,p2)};Player1.prototype.render=function(){this.paddle.render(),this.score.render()},Player1.prototype.update=function(){document.onmousemove=function(){new_mouse=window.event.pageY-pH/2},this.paddle.move(this.paddle.x,new_mouse)},Player2.prototype.render=function(){this.paddle.render(),this.score.render()},Player2.prototype.update=function(){this.paddle.y=p1.paddle.y},Paddle.prototype.render=function(){c.fillStyle="#FFFFFF",c.fillRect(this.x,this.y,this.width,this.height)},Paddle.prototype.move=function(e,t){this.y=t<0?0:t>h-pH?h-pH:t,this.x=e,this.y_speed=-(t-mouse),mouse=t},Score.prototype.render=function(){c.font="160px sans-serif",c.fillStyle="white",c.textAlign="center",c.fillText(this.text,this.x,this.y)},Ball.prototype.render=function(){c.beginPath(),c.arc(this.x,this.y,this.radius,2*Math.PI,!1),c.fill()},Ball.prototype.update=function(e,t){this.x+=this.x_speed,this.y+=this.y_speed;var i=this.x-this.radius,s=this.y-this.radius,d=this.x+this.radius,p=this.y+this.radius;s<0?this.y_speed=-this.y_speed:p>h&&(this.y_speed=-this.y_speed),d<0?(this.x=w/2,this.y=h/2,this.x_speed=-spd,this.y_speed=-spd,t.score.text++):i>w&&(this.x=w/2,this.y=h/2,this.x_speed=-spd,this.y_speed=spd,e.score.text++),i<e.paddle.x+pW&&i>e.paddle.x&&e.paddle.y<this.y&&e.paddle.y+pH>this.y&&(this.x=e.paddle.x+2*pW,this.x_speed=-this.x_speed,this.y_speed+=e.paddle.y_speed/2,this.y+=this.y_speed),d<t.paddle.x+pW&&d>t.paddle.x&&t.paddle.y<this.y&&t.paddle.y+pH>this.y&&(this.x=t.paddle.x-pW,this.x_speed=-this.x_speed,this.y_speed+=t.paddle.y_speed/2,this.y+=this.y_speed)};